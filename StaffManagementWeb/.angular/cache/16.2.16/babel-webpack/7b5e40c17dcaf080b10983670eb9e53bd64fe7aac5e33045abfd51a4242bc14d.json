{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/ssanstar/Desktop/Company_Projects/Personal/StaffManagement.Web/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport axios from 'axios';\nimport { saveAs } from 'file-saver';\nimport * as i0 from \"@angular/core\";\nexport class StaffService {\n  constructor() {\n    this.baseUrl = 'https://localhost:5001/api/staffs'; // your ASP.NET backend URL\n  }\n\n  getAll() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      const res = yield axios.get(_this.baseUrl);\n      return res.data;\n    })();\n  }\n  getById(id) {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      const res = yield axios.get(`${_this2.baseUrl}/${id}`);\n      return res.data;\n    })();\n  }\n  save(staff, isEdit) {\n    var _this3 = this;\n    return _asyncToGenerator(function* () {\n      if (isEdit) yield axios.put(_this3.baseUrl, staff);else yield axios.post(_this3.baseUrl, staff);\n    })();\n  }\n  delete(id) {\n    var _this4 = this;\n    return _asyncToGenerator(function* () {\n      yield axios.delete(`${_this4.baseUrl}/${id}`);\n    })();\n  }\n  search(filters) {\n    var _this5 = this;\n    return _asyncToGenerator(function* () {\n      const params = new URLSearchParams();\n      if (filters.staffId) params.append('staffId', filters.staffId);\n      if (filters.gender) params.append('gender', filters.gender.toString());\n      if (filters.startDate) params.append('startDate', filters.startDate);\n      if (filters.endDate) params.append('endDate', filters.endDate);\n      if (filters.export) params.append('export', filters.export);\n      const response = yield axios.get(`${_this5.baseUrl}?${params.toString()}`);\n      return response.data;\n    })();\n  }\n  export(filters) {\n    var _this6 = this;\n    return _asyncToGenerator(function* () {\n      const params = new URLSearchParams();\n      if (filters.staffId) params.append('staffId', filters.staffId);\n      if (filters.gender) params.append('gender', filters.gender.toString());\n      if (filters.startDate) params.append('startDate', filters.startDate);\n      if (filters.endDate) params.append('endDate', filters.endDate);\n      if (filters.export) params.append('export', filters.export);\n      // Use responseType 'blob' for file download\n      const response = yield axios.get(`${_this6.baseUrl}?${params.toString()}`, {\n        responseType: 'blob'\n      });\n      const mimeType = filters.export === 'EXCEL' ? 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' : 'application/pdf';\n      console.log(mimeType);\n      const blob = new Blob([response.data], {\n        type: mimeType\n      });\n      const fileName = `Staffs_${new Date().toISOString()}.${filters.export === 'EXCEL' ? 'xlsx' : 'pdf'}`;\n      saveAs(blob, fileName);\n    })();\n  }\n  static {\n    this.ɵfac = function StaffService_Factory(t) {\n      return new (t || StaffService)();\n    };\n  }\n  static {\n    this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n      token: StaffService,\n      factory: StaffService.ɵfac,\n      providedIn: 'root'\n    });\n  }\n}","map":{"version":3,"names":["axios","saveAs","StaffService","constructor","baseUrl","getAll","_this","_asyncToGenerator","res","get","data","getById","id","_this2","save","staff","isEdit","_this3","put","post","delete","_this4","search","filters","_this5","params","URLSearchParams","staffId","append","gender","toString","startDate","endDate","export","response","_this6","responseType","mimeType","console","log","blob","Blob","type","fileName","Date","toISOString","factory","ɵfac","providedIn"],"sources":["C:\\Users\\ssanstar\\Desktop\\Company_Projects\\Personal\\StaffManagement.Web\\src\\app\\services\\staff.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\r\nimport axios from 'axios';\r\nimport { saveAs } from 'file-saver';\r\n\r\nexport interface Staff {\r\n  staffId: string;\r\n  fullName: string;\r\n  birthday: string;\r\n  gender: number;\r\n}\r\n\r\n@Injectable({ providedIn: 'root' })\r\nexport class StaffService {\r\n  private baseUrl = 'https://localhost:5001/api/staffs'; // your ASP.NET backend URL\r\n\r\n   async getAll(): Promise<Staff[]> {\r\n    const res = await axios.get(this.baseUrl);\r\n    return res.data;\r\n  }\r\n\r\n  async getById(id: string): Promise<Staff> {\r\n    const res = await axios.get(`${this.baseUrl}/${id}`);\r\n    return res.data;\r\n  }\r\n\r\n  async save(staff: Staff, isEdit: boolean) {\r\n    if (isEdit)\r\n    await axios.put(this.baseUrl, staff);\r\n  else\r\n    await axios.post(this.baseUrl, staff);\r\n  }\r\n\r\n  async delete(id: string) {\r\n    await axios.delete(`${this.baseUrl}/${id}`);\r\n  }\r\n\r\n  async search(filters: {\r\n    staffId?: string;\r\n    gender?: number;\r\n    startDate?: string;\r\n    endDate?: string;\r\n    export?: string;\r\n  }): Promise<Staff[]> {\r\n    const params = new URLSearchParams();\r\n\r\n    if (filters.staffId) params.append('staffId', filters.staffId);\r\n    if (filters.gender) params.append('gender', filters.gender.toString());\r\n    if (filters.startDate) params.append('startDate', filters.startDate);\r\n    if (filters.endDate) params.append('endDate', filters.endDate);\r\n    if (filters.export) params.append('export', filters.export);\r\n\r\n    const response = await axios.get<Staff[]>(`${this.baseUrl}?${params.toString()}`);\r\n    \r\n    return response.data;\r\n  }\r\n\r\n  async export(filters: {\r\n    staffId?: string;\r\n    gender?: number;\r\n    startDate?: string;\r\n    endDate?: string;\r\n    export?: string;\r\n  }): Promise<void> {\r\n    const params = new URLSearchParams();\r\n\r\n    if (filters.staffId) params.append('staffId', filters.staffId);\r\n    if (filters.gender) params.append('gender', filters.gender.toString());\r\n    if (filters.startDate) params.append('startDate', filters.startDate);\r\n    if (filters.endDate) params.append('endDate', filters.endDate);\r\n    if (filters.export) params.append('export', filters.export);\r\n\r\n    // Use responseType 'blob' for file download\r\n    const response = await axios.get(`${this.baseUrl}?${params.toString()}`, {\r\n        responseType: 'blob',\r\n    });\r\n\r\n    const mimeType =\r\n    filters.export === 'EXCEL'\r\n      ? 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'\r\n      : 'application/pdf';\r\n    \r\n        console.log(mimeType);\r\n    const blob = new Blob([response.data], { type: mimeType });\r\n    const fileName = `Staffs_${new Date().toISOString()}.${filters.export === 'EXCEL' ? 'xlsx' : 'pdf'}`;\r\n\r\n    saveAs(blob, fileName);\r\n  }\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}